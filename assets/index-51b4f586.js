import{r as u,a as N,C as E,B as j,F as P,S as w,T as B,L as O,b as z,c as H}from"./antd-043905a8.js";import{u as F}from"./react-dropzone-1e1f69c3.js";import"./konva-b6957d23.js";import{S as M,G as $,T as k,R as U,L as K,I as Y}from"./react-konva-e5110db8.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const s of e.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function c(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(n){if(n.ep)return;n.ep=!0;const e=c(n);fetch(n.href,e)}})();var y={},q={get exports(){return y},set exports(a){y=a}},C={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A=u,G=Symbol.for("react.element"),V=Symbol.for("react.fragment"),X=Object.prototype.hasOwnProperty,J=A.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q={key:!0,ref:!0,__self:!0,__source:!0};function D(a,t,c){var r,n={},e=null,s=null;c!==void 0&&(e=""+c),t.key!==void 0&&(e=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)X.call(t,r)&&!Q.hasOwnProperty(r)&&(n[r]=t[r]);if(a&&a.defaultProps)for(r in t=a.defaultProps,t)n[r]===void 0&&(n[r]=t[r]);return{$$typeof:G,type:a,key:e,ref:s,props:n,_owner:J.current}}C.Fragment=V;C.jsx=D;C.jsxs=D;(function(a){a.exports=C})(q);const L=y.Fragment,o=y.jsx,h=y.jsxs;var T,I=N;T=I.createRoot,I.hydrateRoot;const f=u.createContext({rectangleWidth:45,rectangleHeight:15}),Z=({children:a})=>{const[t,c]=u.useState(void 0),[r,n]=u.useState(45),[e,s]=u.useState(15),[i,l]=u.useState([]),m=d=>l([...i,{...d,x:d.x-r/2,y:d.y-e/2,value:_(t,d.x,d.y,r,e)}]),g=d=>l(i.filter((p,R)=>R!==d)),x=(d,p)=>l(i.map((R,W)=>W===d?{...R,...p,value:_(t,p.x,p.y,r,e)}:R)),v=()=>l(i.map(d=>({...d,value:_(t,d.x,d.y,r,e)}))),b=d=>{const p=new Image;p.src=URL.createObjectURL(d[0]),p.onload=()=>c(p)},{getRootProps:S}=F({onDrop:b,noClick:!0});return u.useEffect(()=>{v()},[r,e,t]),o(f.Provider,{value:{image:t,rectangleWidth:r,setRectangleHeight:s,rectangleHeight:e,setRectangleWidth:n,rectangles:i,addRectangle:m,deleteRectangle:g,updateRectangle:x},children:o("div",{...S(),children:a})})},_=(a,t,c,r,n)=>{if(!a)return 0;const e=document.createElement("canvas");e.width=r,e.height=n;const s=e.getContext("2d");if(!s)throw new Error("No context");s.drawImage(a,t,c,r,n,0,0,r,n);const l=s.getImageData(0,0,r,n).data;let m=0;for(let g=0;g<l.length;g+=4)m+=l[g]+l[g+1]+l[g+2];return Math.round(m/(l.length/3))},ee=({children:a,parentHeight:t,parentWidth:c})=>{const{addRectangle:r}=u.useContext(f),[n,e]=u.useState(0),[s,i]=u.useState(0);return o(M,{width:c,height:t,onClick:g=>{if(!g.evt.ctrlKey)return;const x=g.target.getStage();if(!x)return console.error("No stage");const v=x.getPointerPosition();if(!v)return console.error("No pointer position");let{x:b,y:S}=v;r({x:b-n,y:S-s})},draggable:!0,onDragEnd:g=>{e(g.target.x()),i(g.target.y())},children:a})},te=({value:a,x:t,y:c,width:r,height:n,onDragMove:e,onClick:s})=>h($,{x:t,y:c,onDragMove:e,onClick:s,draggable:!0,children:[o(k,{text:`${a}`,stroke:"blue",strokeWidth:1}),o(U,{width:r,height:n,stroke:"red",strokeWidth:1})]}),ne=()=>{const{deleteRectangle:a,updateRectangle:t,rectangles:c,rectangleHeight:r,rectangleWidth:n}=u.useContext(f),e=(i,l)=>{const m=[...c];m[i]={...m[i],x:l.target.x(),y:l.target.y()},t(i,{x:l.target.x(),y:l.target.y()})},s=(i,l)=>{l.evt.ctrlKey&&(a(i),l.cancelBubble=!0)};return o(L,{children:c.map((i,l)=>o(te,{width:n,height:r,onDragMove:m=>e(l,m),onClick:m=>s(l,m),...i},l))})},re=()=>{const{image:a}=u.useContext(f),t=u.useRef(null),[c,r]=u.useState(0),[n,e]=u.useState(0);return u.useEffect(()=>{if(!t.current)return;const{width:s,height:i}=t.current.getBoundingClientRect();r(s),e(i)},[t]),o(E,{title:"Canvas",size:"small",ref:t,style:{minHeight:"100%"},children:n&&c&&o(ee,{parentWidth:c,parentHeight:n,children:h(K,{children:[a?o(Y,{image:a}):o(k,{text:"Drag and drop a picture",x:c/2-60,y:n/2-5}),o(ne,{})]})})})},oe=()=>{const{rectangleWidth:a,setRectangleWidth:t,rectangleHeight:c,setRectangleHeight:r}=u.useContext(f);return h(E,{title:h(L,{children:["Settings",o(j,{type:"default",size:"small",style:{float:"right"},onClick:()=>(t(45),r(15)),children:"Reset"})]}),size:"small",children:[o(P.Item,{label:"Width",children:o(w,{min:5,max:100,onChange:t,value:a})}),o(P.Item,{label:"Height",children:o(w,{min:5,max:40,onChange:r,value:c})})]})},ae=()=>{const{rectangles:a}=u.useContext(f),t=[...a].sort((e,s)=>e.x-s.x),c=[t.reduce((e,s,i)=>({...e,[i]:s.value}),{key:0})],r=t.map((e,s)=>({dataIndex:s,title:s+1}));return o(E,{title:h(L,{children:["Table",o(j,{type:"primary",size:"small",style:{float:"right"},onClick:()=>navigator.clipboard.writeText(c.map(e=>Object.values(e).join("	")).join("\r")),children:"Copy"})]}),size:"small",children:o(B,{size:"small",pagination:!1,dataSource:c,columns:r,style:{overflow:"auto"}})})};T(document.getElementById("root")).render(o(u.StrictMode,{children:o(Z,{children:o(O,{children:o(O.Content,{children:h(z,{style:{minHeight:window.innerHeight},children:[o(H,{span:18,children:o(re,{})}),h(H,{span:6,children:[o(oe,{}),o(ae,{})]})]})})})})}));
